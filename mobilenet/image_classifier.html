<html>
  <head>
    <style>
      body {
        background-color : #555;
        color:#ccc;
      }
    </style>
    
    <!-- Load TensorFlow.js. This is required to use MobileNet. -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.1"> </script>
    <!-- Load the MobileNet model. -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet@1.0.0"> </script>

    <!-- Place your code in the script tag below. You can also use an external .js file -->
    <script>
      let model;
      let img;
      window.onload = () => {
        img = document.getElementById('img');
        img.onload = ()=>classify(img);

        // Load the model.
        mobilenet.load().then(m => {
          model = m;          
          classify(img);
        });
      }

      function changeImage(el) {
        if (el.files.length > 0) {
          img.src = URL.createObjectURL(el.files[0]);
        }        
      }

      function classify(image) {
        const result = document.getElementById('result');
        model.classify(image).then(predictions => {
          result.innerHTML = "Predictions: " + JSON.stringify(predictions);
        });
      }
    </script>
  </head>
  <body>
    <!-- Replace this with your image. Make sure CORS settings allow reading the image! -->
    <img crossorigin = "anonymous" id="img" src="https://truemaxdh.github.io/PlayML.js/mobilenet/cat.png"></img>
    <div id="result"></div>
    change image : <input type="file" accept="image/*" onchange="changeImage(this);">
    F<video id="player" controls autoplay></video>
    <button id="capture">Capture</button>
    <canvas id="canvas" width=320 height=240></canvas>
    <script>
      const player = document.getElementById('player');
      const canvas = document.getElementById('canvas');
      const context = canvas.getContext('2d');
      const captureButton = document.getElementById('capture');
    
      const constraints = {
        video: true,
      };
    
      captureButton.addEventListener('click', () => {
        // Draw the video frame to the canvas.
        context.drawImage(player, 0, 0, canvas.width, canvas.height);
        img.src = canvas.toDataURL();

        // Stop all video streams.
        player.srcObject.getVideoTracks().forEach(track => track.stop());
      });
    
      // Attach the video stream to the video element and autoplay.
      navigator.mediaDevices.getUserMedia(constraints)
        .then((stream) => {
          player.srcObject = stream;
        });
    </script>
  </body>
</html>
